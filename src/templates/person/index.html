<!DOCTYPE html>
<html lang="en">

<head>
  <title>CT - {{person.fullname}}</title>
  {{> head}}
</head>

<body>

  {{> nav}}

  <section class="hero is-info is-bold">
    <div class="hero-body">
      <div class="container">
        <h1 class="title is-1">
          {{person.fullname}}
        </h1>
        {{#if person.nextBirthday}}
        <h2 class="subtitle is-3">{{datePrettyNoYear person.nextBirthday}}</h2>{{/if}}
      </div>
    </div>
  </section>
  {{> a2z-hero}}
  <section class="section">
    <div class="container">

      <h2 class="title">When and where to send cards &amp; letters</h2>
      <h3 class="subtitle">Here's where I keep all the information I need to get stuff sent off smartish</h3>
      <div class="columns">
        <div class="column is-one-quarter">
          <strong>Birthday</strong>
        </div>
        <div class="column">
          {{#if person.nextBirthday}} {{datePretty person.nextBirthday}}
          <small>({{timeAgo person.nextBirthday}})</small>
          {{/if}}
        </div>
      </div>

      <div class="columns">
        <div class="column is-one-quarter">
          <strong>Age</strong>
        </div>
        <div class="column">
          {{person.age}}
        </div>
      </div>

      <div class="columns">
        <div class="column is-one-quarter">
          <strong>Address</strong>
        </div>
        <div class="column">{{{addReturns person.address}}}</div>
      </div>

      <div class="columns">
        <div class="column is-one-quarter">
          <strong>Country</strong>
        </div>
        <div class="column">{{person.country}}</div>
      </div>

      <div class="columns">
        <div class="column is-one-quarter">

        </div>
        <div class="column">
          <a class="button is-link" href="/person/{{person.id}}/edit">Edit</a>
        </div>
      </div>
    </div>
  </section>


  <section class="section">
    <div class="container">
      <hr />

      <form method="POST" action="/person/{{person.id}}">
        <h2 class="title"><a name="notes" class="has-text-black" style="cursor: default">Notes</a></h2>
        <h3 class="subtitle">Pop all the stuff I know I should know in here but my memory isn't what it used to be</h3>

        <div class="field">
          <div class="control">
            <textarea class="textarea" name="notes" placeholder="Notes go here" rows="12">{{person.notes}}</textarea>
          </div>
        </div>

        <div class="level">
          <div class="level-left">
            <div class="level-item">&nbsp;</div>
          </div>
          <div class="level-right">
            <div class="level-item control">
              <input class="button is-primary" type="submit" name="action" value="Save notes">
            </div>
          </div>
        </div>
      </form>

    </div>
  </section>

  <section class="section">
    <div class="container">
      <hr />

      <h2 class="title">
        <a name="when-stuff-was-sent" class="has-text-black" style="cursor: default">When stuff was sent</a>
      </h2>
      {{#if person.contacted}}
      <h3 class="subtitle">This is when I sent letters or cards, so when I go "Oh when did I send that letter?" I can
        see here.</h3>
      <h4 class="subtitle is-6">The two checkboxes can help if I sent something with tracking, once I've checked it's
        arrived I can mark it off.</h4>
      {{else}}
      <h3 class="subtitle">Drop a quick note here when I sent something, to help me remember when I did it.</h3>
      {{/if}}

      <form method="POST" action="/person/{{person.id}}">
        {{#each person.contacted}}
        <div class="level highlight">
          <div class="level-left">
            <div class="level-item">
              <div>
                <div class="has-text-weight-semibold is-size-5">
                  {{details}}
                </div>
                <div class="is-size-6">
                  {{datePretty created}} ({{timeAgo created}})
                </div>
              </div>

              <input type="hidden" name="ids" value="{{id}}" />
            </div>
          </div>

          <div class="level-right">
            <div class="level-item">
              <label class="checkbox">
                <input class="" type="checkbox" name="checkbox1_{{id}}" value="true" {{#if checked1}} checked{{/if}}>
                  Check 1 </label> </div> <div class="level-item">
                <label class="checkbox">
                  <input class="" type="checkbox" name="checkbox2_{{id}}" value="true" {{#if checked2}} checked{{/if}}>
                    Check 2 </label> </div> <div class="level-item">
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>

            <div class="level-item">
              <button class="level-item button is-danger" type="submit" name="action" value="remove_{{id}}">Delete</button>
            </div>
          </div>
        </div>
        {{/each}} {{#if person.contacted}}
        <div class="level">
          <div class="level-left">
            <div class="level-item">&nbsp;</div>
          </div>
          <div class="level-right">
            <div class="level-item">
              <button class="level-item button is-primary" type="submit" name="action" value="update_checkboxes">Update
                the checkboxes</button>
            </div>
          </div>
        </div>
        {{/if}}
      </form>


      <form method="POST" action="/person/{{person.id}}">
        {{#if person.contacted}}
        <div>&nbsp;</div>
        <h3 class="subtitle">Drop a quick note here when I sent something, to help me remember when I did it.</h3>
        {{/if}}
        <div class="field">
          <div class="control">
            <input class="input" type="text" name="newcontact" placeholder="Add details about how, why you contacted someone here">
          </div>
        </div>

        <div class="level">
          <div class="level-left">
            <div class="level-item">&nbsp;</div>
          </div>
          <div class="level-right">
            <div class="level-item control">
              <button class="level-item button is-primary" type="submit" name="action" value="Add contacted">I just
                sent a thing!</button>
            </div>
          </div>
        </div>


      </form>

    </div>
  </section>


  <section class="section">
    <div class="container">
      <hr />

      <h2 class="title">
        <a name="other-dates" class="has-text-black" style="cursor: default">Other dates</a>
      </h2>
      {{#if person.upcomingDates}}
      <h3 class="subtitle">These are other things I figured I should remember.</h3>
      {{else}}
      <h3 class="subtitle">Add a date that I should pay attention to, like kids' birthdays or anniversaries.</h3>
      {{/if}} {{#each person.upcomingDates}}
      <form method="POST" action="/person/{{../person.id}}">
        <div class="level highlight bottom-7">
          <div class="level-left">
            <div class="level-item">
              <div>
                <div class="has-text-weight-semibold is-size-5">
                  {{details}}
                </div>
                <div class="is-size-6">
                  {{datePretty nextOccurance}} ({{timeAgo nextOccurance}})
                </div>
              </div>
              <input type="hidden" name="dateId" value="{{id}}" />
            </div>
          </div>
          <div class="level-right">
            <div class="level-item">
              <button class="level-item button is-danger" type="submit" name="action" value="deleteOtherDate">Delete</button>
            </div>
          </div>
        </div>
      </form>
      {{/each}}

      <form method="POST" action="/person/{{person.id}}">
        {{#if person.upcomingDates}}
        <div>&nbsp;</div>
        <h3 class="subtitle">Add a date that I should pay attention to, like kids' birthdays or anniversaries.</h3>
        {{/if}}

        <div class="field">
          <label class="label">Month</label>
          <div class="select">
            <select name="month">
              <option value='1'>01 - January</option>
              <option value='3'>03 - March</option>
              <option value='2'>02 - February</option>
              <option value='4'>04 - April</option>
              <option value='5'>05 - May</option>
              <option value='6'>06 - June</option>
              <option value='7'>07 - July</option>
              <option value='8'>08 - August</option>
              <option value='9'>09 - September</option>
              <option value='10'>10 - October</option>
              <option value='11'>11 - November</option>
              <option value='12'>12 - December</option>
            </select>
          </div>
        </div>

        <div class="field">
          <label class="label">Day</label>
          <div class="control">
            <input class="input narrow-input" type="number" min="1" max="31" name="day" placeholder="1">
          </div>
        </div>

        <div class="field">
          <label class="label">Details of the thing</label>
          <div class="control">
            <input class="input" type="text" name="details" placeholder="Add details about the date here">
          </div>
        </div>

        <div class="level">
          <div class="level-left">
            <div class="level-item">&nbsp;</div>
          </div>
          <div class="level-right">
            <div class="level-item control">
              <button class="level-item button is-primary" type="submit" name="action" value="Add date">Save this new
                date</button>
            </div>
          </div>
        </div>

      </form>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <hr />

      <h2 class="title">
        <a name="connections" class="has-text-black" style="cursor: default">Connections</a>
      </h2>
      {{#if person.connections}}
      <h3 class="subtitle">These are the other people this person is connected to</h3>
      <p>
        {{#each person.connections}}
        <form method="POST" action="/person/{{../person.id}}">
          <div class="level highlight bottom-7">
            <div class="level-left">
              <div class="level-item">
                <div>
                  <div class="is-size-5">
                    <span class="has-text-weight-bold">{{../person.fullname}}</span> is {{relationship}} to <a class="has-text-weight-bold"
                      href="/person/{{connector}}">{{fullname}}</a>
                  </div>
                </div>
                <input type="hidden" name="relationship" value="{{relationship}}" />
                <input type="hidden" name="connector" value="{{id}}" />
              </div>
            </div>
            <div class="level-right">
              <div class="level-item">
                <button class="level-item button is-danger" type="submit" name="action" value="deleteRelationship">Delete</button>
              </div>
            </div>
          </div>
        </form>
        {{/each}}
        &nbsp;
      </p>
      {{/if}}

      {{#ifEqual config.startConnection person.id}}
      <div class="notification is-info">
        This person is set to be connected to someone else. I should <a href="/everyone">go and find</a> the person I
        need to connect them to.
      </div>
      <div class="field">
        <div class="control has-text-centered">
          <form method="POST" action="/person/{{../person.id}}">
            <button class="button is-warning" type="submit" name="action" value="stopConnecting">
              Stop trying to connect this person
            </button>
          </form>
        </div>
      </div>
      {{else}}
      {{#if ../connector}}
      <h3 class="subtitle">Do you wish to connect <a class="has-text-weight-bold" href="/person/{{../../connector.id}}#connections">{{../../connector.fullname}}</a>
        to
        <span class="has-text-weight-bold">{{../../person.fullname}}?</span></h3>
      <div class="level">
        <h2 class="title level-item">{{../../connector.fullname}} is...</h2>
      </div>
      <form method="POST" action="/person/{{../../person.id}}">
        <div class="level">
          <div class="level-item control">
            <button class="button is-primary" type="submit" name="action" value="parentOf">...parent of...</button>
          </div>
          <div class="level-item control">
            <button class="button is-primary" type="submit" name="action" value="childOf">...child of...</button>
          </div>
          <div class="level-item control">
            <button class="button is-primary" type="submit" name="action" value="siblingOf">...sibling of...</button>
          </div>
          <div class="level-item control">
            <button class="button is-primary" type="submit" name="action" value="partnerOf">...partner of...</button>
          </div>
          <div class="level-item control">
            <button class="button is-primary" type="submit" name="action" value="otherOf">...other of...</button>
          </div>
        </div>
        <div class="level">
          <h2 class="title level-item">...{{../../person.fullname}}</h2>
        </div>
      </form>
      {{else}}
      <h3 class="subtitle">Is this person connected to someone else, if so make that connection here.</h3>
      <div class="field">
        <div class="control has-text-centered">
          <form method="POST" action="/person/{{../../person.id}}">
            <button class="button is-primary" type="submit" name="action" value="startConnecting">
              Start connecting this person to someone else
            </button>
          </form>
        </div>
      </div>
      {{/if}}
      {{/ifEqual}}



    </div>
  </section>

  <section class="section">
    <div class="container">
      <hr />
      <h2 class="title">Metadata &amp; danger settings</h2>
      <h3 class="subtitle">Here's the stuff that the system knows but is only kinda useful, and the hide/delete user
        buttons.</h3>

      <form method="POST " action="/person/{{person.id}} ">
        <div class="columns ">
          <div class="column is-one-quarter ">
            <strong>Source</strong>
          </div>
          <div class="column ">{{person.source}}</div>
        </div>

        <div class="columns ">
          <div class="column is-one-quarter ">
            <strong>Last updated</strong>
          </div>
          <div class="column ">{{datePretty person.updated}}
            <small>({{timeAgo person.updated}})</small>
          </div>
        </div>

        <div class="columns ">
          <div class="column is-one-quarter ">
            <strong>Created</strong>
          </div>
          <div class="column ">{{datePretty person.created}}
            <small>({{timeAgo person.created}})</small>
          </div>
        </div>

        <div class="columns ">
          <div class="column is-one-quarter ">&nbsp;</div>
          <div class="column ">
            <div class="level ">
              <div class="level-left ">
                <div class="level-item ">
                  {{#if person.hidden}}
                  <a class="button is-warning " href="/person/{{person.id}}/unhide ">Unhide person</a>
                  {{else}}
                  <a class="button is-warning " href="/person/{{person.id}}/hide ">Hide person</a>
                  {{/if}}
                </div>
                <div class="level-item ">
                  <a class="button is-danger " href="/person/{{person.id}}/delete ">Delete person</a>
                </div>

              </div>
            </div>
          </div>
        </div>

      </form>
    </div>
  </section>

  {{>footer}}
</body>

</html>